import{r as d,j as e,H as J,L as _,a as x,b as K}from"./app-CbXMUvGG.js";import{A as T,S as Q}from"./Sidebar-VrN9mjbX.js";function E(){return{user:K()?.props?.auth?.user??null}}function X(s){const r=s?.rooms??[];return{rooms:Array.isArray(r)?r:r?.data??[],paginator:r}}function u({variant:s="default",className:r="",...n}){const l="inline-flex items-center justify-center rounded px-3 py-2 text-sm",t={default:"bg-blue-600 text-white hover:bg-blue-700",outline:"border border-gray-300 text-gray-700 hover:bg-gray-50",danger:"bg-red-600 text-white hover:bg-red-700",ghost:"text-gray-700 hover:bg-gray-100"};return e.jsx("button",{className:`${l} ${t[s]} ${r}`,...n})}function b(s){return e.jsx("input",{...s,className:`border rounded px-3 py-2 ${s.className||""}`})}function Y({room:s,onClose:r}){if(!s)return null;const n=t=>{switch(t){case"conference":return e.jsx("svg",{className:"w-6 h-6 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})});case"office":return e.jsx("svg",{className:"w-6 h-6 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})});case"training":return e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})});default:return e.jsxs("svg",{className:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}},l=t=>({conference:"Salle de confÃ©rence",office:"Bureau",training:"Salle de formation"})[t]||t;return e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded shadow w-full max-w-lg",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between",children:[e.jsxs("div",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:n(s.type)}),s.room_number]}),e.jsx("button",{onClick:r,className:"px-2 py-1 rounded hover:bg-gray-100",children:"âœ•"})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Type :"})," ",l(s.type)]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"CapacitÃ© :"})," ",s.capacity," personnes"]}),s.description&&e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 font-medium mb-1",children:"Description :"}),e.jsx("p",{className:"text-gray-800 whitespace-pre-line text-sm",children:s.description})]})]}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2",children:[e.jsx(u,{variant:"outline",onClick:r,children:"Fermer"}),e.jsx(u,{onClick:()=>x.visit(`/reservations/create?room_id=${s.id}`),children:"RÃ©server"})]})]})})}function Z({initialRoom:s,onClose:r,onSubmit:n}){const[l,t]=d.useState(()=>({room_number:s?.room_number||"",type:s?.type||"conference",capacity:s?.capacity||"",description:s?.description||""}));d.useEffect(()=>{s&&t({room_number:s.room_number||"",type:s.type||"conference",capacity:s.capacity||"",description:s.description||""})},[s]);const c=i=>{i.preventDefault(),n(s.id,l)};return s?e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded shadow w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-4 border-b flex items-center justify-between sticky top-0 bg-white",children:[e.jsx("div",{className:"text-lg font-semibold",children:"Modifier la salle"}),e.jsx("button",{onClick:r,className:"px-2 py-1 rounded hover:bg-gray-100",children:"âœ•"})]}),e.jsxs("form",{onSubmit:c,className:"p-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-700",children:"NumÃ©ro de salle"}),e.jsx(b,{className:"w-full mt-1",value:l.room_number,onChange:i=>t({...l,room_number:i.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-700",children:"Type"}),e.jsxs("select",{className:"w-full mt-1 border rounded px-3 py-2",value:l.type,onChange:i=>t({...l,type:i.target.value}),required:!0,children:[e.jsx("option",{value:"conference",children:"Salle de confÃ©rence"}),e.jsx("option",{value:"office",children:"Bureau"}),e.jsx("option",{value:"training",children:"Salle de formation"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-700",children:"CapacitÃ©"}),e.jsx(b,{className:"w-full mt-1",type:"number",min:"1",value:l.capacity,onChange:i=>t({...l,capacity:i.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-700",children:"Description"}),e.jsx("textarea",{rows:4,className:"w-full mt-1 border rounded px-3 py-2",value:l.description,onChange:i=>t({...l,description:i.target.value})})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(u,{variant:"outline",type:"button",onClick:r,children:"Annuler"}),e.jsx(u,{type:"submit",children:"Enregistrer"})]})]})]})}):null}function ee({room:s,onCancel:r,onConfirm:n}){return s?e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded shadow w-full max-w-sm",children:[e.jsx("div",{className:"p-4 border-b text-lg font-semibold",children:"Supprimer la salle"}),e.jsxs("div",{className:"p-4 text-sm text-gray-700",children:['Confirmer la suppression de la salle "',s.room_number,'" ?']}),e.jsxs("div",{className:"p-4 border-t flex justify-end gap-2",children:[e.jsx(u,{variant:"outline",onClick:r,children:"Annuler"}),e.jsx(u,{variant:"danger",onClick:()=>n(s),children:"Supprimer"})]})]})}):null}function se({room:s,user:r,onOpenDetails:n,onOpenEdit:l,onOpenDelete:t,onReserve:c}){const i=r?.role==="admin",p=h=>{switch(h){case"conference":return e.jsx("svg",{className:"w-full h-full text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h8a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm3 1h6v4H7V5zm8 8v2a1 1 0 01-1 1H6a1 1 0 01-1-1v-2h10zm-6-4a1 1 0 100 2 1 1 0 000-2z",clipRule:"evenodd"})});case"office":return e.jsx("svg",{className:"w-full h-full text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 2a1 1 0 00-1 1v14a1 1 0 001 1h12a1 1 0 001-1V3a1 1 0 00-1-1H4zm3 3a1 1 0 000 2h6a1 1 0 100-2H7zm0 4a1 1 0 100 2h6a1 1 0 100-2H7zm0 4a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})});case"training":return e.jsx("svg",{className:"w-full h-full text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.75 2.524z"})});default:return e.jsx("svg",{className:"w-full h-full text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}},N=h=>{switch(h){case"conference":return"from-purple-500 to-purple-600";case"office":return"from-green-500 to-green-600";case"training":return"from-orange-500 to-orange-600";default:return"from-blue-500 to-blue-600"}},g=h=>({conference:"Salle de confÃ©rence",office:"Bureau",training:"Salle de formation"})[h]||h;return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm hover:shadow-md transition-all duration-300 border border-gray-100 overflow-hidden group",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-48 overflow-hidden",children:e.jsx("div",{className:`w-full h-full bg-gradient-to-r ${N(s.type)} flex items-center justify-center`,children:e.jsx("div",{className:"rounded-full bg-white/10 p-8",children:e.jsx("div",{className:"text-white opacity-90 w-20 h-20",children:p(s.type)})})})}),e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx("span",{className:"bg-white/90 text-gray-800 px-4 py-2 rounded-full text-sm font-medium backdrop-blur-sm",children:g(s.type)})})]}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-900 group-hover:text-gray-700 transition-colors",children:["Salle ",s.room_number]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),e.jsxs("span",{className:"text-sm",children:[s.capacity," personnes"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-4m-5 0H3m2 0h3M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),e.jsx("span",{className:"text-sm",children:g(s.type)})]})]}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:s.description})]}),e.jsxs("div",{className:"mt-5 flex gap-2 justify-end",children:[e.jsx(u,{variant:"ghost",onClick:()=>n(s.id),className:"text-gray-700 hover:text-gray-900",children:"DÃ©tails"}),!i&&e.jsx(u,{variant:"default",onClick:()=>c(s.id),className:"text-white bg-gray-900 hover:bg-black",children:"RÃ©server"}),i&&e.jsxs(e.Fragment,{children:[e.jsx(u,{variant:"outline",onClick:()=>l(s.id),className:"text-gray-600 hover:text-gray-900",children:"Modifier"}),e.jsx(u,{variant:"danger",onClick:()=>t(s),className:"text-red-600 hover:text-red-700",children:"Supprimer"})]})]})]})]})}function te({onClose:s,onSubmit:r}){const[n,l]=d.useState({room_number:"",type:"conference",capacity:"",description:""}),t=c=>{c.preventDefault(),r(n)};return e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded shadow w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"p-4 border-b sticky top-0 bg-white",children:[e.jsx("div",{className:"text-lg font-semibold",children:"CrÃ©er une salle"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Remplissez les informations"})]}),e.jsxs("form",{onSubmit:t,className:"p-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-700",children:"NumÃ©ro de salle"}),e.jsx(b,{className:"w-full mt-1",value:n.room_number,onChange:c=>l({...n,room_number:c.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-700",children:"Type"}),e.jsxs("select",{className:"w-full mt-1 border rounded px-3 py-2",value:n.type,onChange:c=>l({...n,type:c.target.value}),required:!0,children:[e.jsx("option",{value:"conference",children:"Salle de confÃ©rence"}),e.jsx("option",{value:"office",children:"Bureau"}),e.jsx("option",{value:"training",children:"Salle de formation"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-700",children:"CapacitÃ©"}),e.jsx(b,{className:"w-full mt-1",type:"number",min:"1",value:n.capacity,onChange:c=>l({...n,capacity:c.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-700",children:"Description"}),e.jsx("textarea",{rows:4,className:"w-full mt-1 border rounded px-3 py-2",value:n.description,onChange:c=>l({...n,description:c.target.value})})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx(u,{variant:"outline",type:"button",onClick:s,children:"Annuler"}),e.jsx(u,{type:"submit",children:"CrÃ©er"})]})]})]})})}function re({room:s,onClose:r,onSubmit:n}){const{user:l}=E(),[t,c]=d.useState({employee_id:l?.id?.toString()||"",date:"",start_time:"",end_time:"",purpose:""}),[i,p]=d.useState(null),N=o=>{switch(o){case"conference":return e.jsx("svg",{className:"w-6 h-6 text-gray-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h8a2 2 0 012 2v12a2 2 0 01-2 2H6a2 2 0 01-2-2V4zm3 1h6v4H7V5zm8 8v2a1 1 0 01-1 1H6a1 1 0 01-1-1v-2h10zm-6-4a1 1 0 100 2 1 1 0 000-2z",clipRule:"evenodd"})});case"office":return e.jsx("svg",{className:"w-6 h-6 text-gray-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4 2a1 1 0 00-1 1v14a1 1 0 001 1h12a1 1 0 001-1V3a1 1 0 00-1-1H4zm3 3a1 1 0 000 2h6a1 1 0 100-2H7zm0 4a1 1 0 100 2h6a1 1 0 100-2H7zm0 4a1 1 0 100 2h6a1 1 0 100-2H7z",clipRule:"evenodd"})});case"training":return e.jsx("svg",{className:"w-6 h-6 text-gray-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.75 2.524z"})});default:return e.jsx("svg",{className:"w-6 h-6 text-gray-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}},g=o=>({conference:"Salle de confÃ©rence",office:"Bureau",training:"Salle de formation"})[o]||o,h=async()=>{if(!s||!t.date||!t.start_time||!t.end_time){p(null);return}try{const o=await window.axios.post(`/rooms/${s.id}/check-availability`,{date:t.date,start_time:t.start_time,end_time:t.end_time});p(o.data)}catch(o){if(console.error("Erreur lors de la vÃ©rification de disponibilitÃ©:",o),t.start_time&&t.end_time){const v=new Date(`1970-01-01T${t.start_time}`),f=new Date(`1970-01-01T${t.end_time}`);v>=f?p({available:!1,message:"L'heure de fin doit Ãªtre aprÃ¨s l'heure de dÃ©but"}):p({available:!0,message:"VÃ©rification indisponible - Salle probablement libre"})}else p({available:!1,message:"Veuillez remplir tous les champs"})}};d.useEffect(()=>{const o=setTimeout(()=>{h()},500);return()=>clearTimeout(o)},[s,t.date,t.start_time,t.end_time]);const w=o=>{if(o.preventDefault(),s){console.log("ðŸš€ DonnÃ©es de rÃ©servation envoyÃ©es (SANS correction frontend):",t),console.log("ðŸ“ Heures exactes:",{start:t.start_time,end:t.end_time});const v={...t,room_id:s.id};n(v)}};return s?e.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded shadow w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-4 border-b sticky top-0 bg-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-semibold flex items-center gap-2",children:[e.jsx("div",{className:"flex-shrink-0",children:N(s.type)}),e.jsxs("span",{children:["RÃ©server la salle ",s.room_number]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[g(s.type)," - CapacitÃ©: ",s.capacity," personnes"]})]}),e.jsx("button",{onClick:r,className:"px-2 py-1 rounded hover:bg-gray-100",children:"âœ•"})]})}),e.jsxs("form",{onSubmit:w,className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-700 font-medium",children:"EmployÃ©"}),e.jsx("div",{className:"w-full mt-1 border rounded px-3 py-2 bg-gray-50 text-gray-700",children:l?`${l.first_name} ${l.name}`:"Non disponible"}),e.jsx("input",{type:"hidden",name:"employee_id",value:t.employee_id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-700 font-medium",children:"Date *"}),e.jsx(b,{type:"date",className:"w-full mt-1",value:t.date,min:new Date().toISOString().split("T")[0],onChange:o=>c({...t,date:o.target.value}),required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-700 font-medium flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414-1.414L9 5.586 7.707 4.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4a1 1 0 00-1.414-1.414L9 5.586z",clipRule:"evenodd"})}),"Heure de DÃ‰BUT *"]}),e.jsx(b,{type:"time",className:"w-full mt-1 border-2 border-green-200 focus:border-green-500",value:t.start_time,onChange:o=>c({...t,start_time:o.target.value}),required:!0,placeholder:"Ex: 09:00"}),t.start_time&&e.jsxs("p",{className:"text-xs text-green-600 mt-1",children:["DÃ©but: ",t.start_time]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm text-gray-700 font-medium flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 text-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})}),"Heure de FIN *"]}),e.jsx(b,{type:"time",className:"w-full mt-1 border-2 border-red-200 focus:border-red-500",value:t.end_time,onChange:o=>c({...t,end_time:o.target.value}),required:!0,placeholder:"Ex: 10:00"}),t.end_time&&e.jsxs("p",{className:"text-xs text-red-600 mt-1",children:["Fin: ",t.end_time]})]})]}),t.start_time&&t.end_time&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("svg",{className:"w-4 h-4 text-blue-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})}),e.jsxs("span",{className:"text-blue-800 font-medium",children:["CrÃ©neaux: ",t.start_time," â†’ ",t.end_time,(()=>{if(t.start_time&&t.end_time){const o=new Date(`1970-01-01T${t.start_time}`),f=(new Date(`1970-01-01T${t.end_time}`)-o)/(1e3*60);return f>0?` (${Math.floor(f/60)}h${f%60?Math.floor(f%60).toString().padStart(2,"0"):"00"})`:" (ERREUR)"}return""})()]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm text-gray-700 font-medium",children:"Objet de la rÃ©union"}),e.jsx("textarea",{rows:3,className:"w-full mt-1 border rounded px-3 py-2",value:t.purpose,onChange:o=>c({...t,purpose:o.target.value}),placeholder:"DÃ©crivez briÃ¨vement l'objet de votre rÃ©union..."})]}),i&&e.jsx("div",{className:`p-3 rounded-md ${i.available?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-2",children:i.available?e.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}):e.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("p",{className:`text-sm font-medium ${i.available?"text-green-800":"text-red-800"}`,children:i.message})]})}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[e.jsx(u,{variant:"outline",type:"button",onClick:r,children:"Annuler"}),e.jsx(u,{type:"submit",disabled:i&&!i.available,children:"CrÃ©er la rÃ©servation"})]})]})]})}):null}function ne(s){const{user:r}=E(),{rooms:n,paginator:l}=X(s),[t,c]=d.useState(""),[i,p]=d.useState("all"),[N,g]=d.useState(!1),[h,w]=d.useState(null),[o,v]=d.useState(null),[f,C]=d.useState(null),[L,S]=d.useState(null),[R,H]=d.useState([]),[B,D]=d.useState(!1),z=d.useRef(null),y=d.useMemo(()=>{const a=t.trim().toLowerCase(),m=j=>{const M=(j.room_number||"").toLowerCase(),P=(j.description||"").toLowerCase(),U=!a||M.includes(a)||P.includes(a),G=i==="all"||j.type===i;return U&&G};return n.filter(m)},[n,t,i]),$=a=>{x.visit(route("rooms.index"),{data:{show:a},only:["room","rooms"],preserveState:!0,preserveScroll:!0,onSuccess:m=>w(m.props?.room||null)})},A=a=>{x.visit(route("rooms.index"),{data:{edit:a},only:["room","rooms"],preserveState:!0,preserveScroll:!0,onSuccess:m=>v(m.props?.room||null)})},k=()=>{g(!1),w(null),v(null),C(null),S(null),x.visit(route("rooms.index"),{replace:!0,only:["rooms"],preserveState:!0,preserveScroll:!0})},V=async a=>{try{const m=y.find(j=>j.id===a);m&&(S(m),R.length===0&&H([{id:r.id,name:r.name,first_name:r.first_name,employee_number:r.employee_number||"001",department:r.department||"IT"}]))}catch(m){console.error("Erreur lors du chargement:",m);const j=y.find(M=>M.id===a);j&&(S(j),H([{id:r.id,name:r.name,first_name:r.first_name,employee_number:r.employee_number||"001",department:r.department||"IT"}]))}},q=a=>{x.post(route("reservations.store"),a,{preserveScroll:!0,onSuccess:()=>{S(null),x.reload({only:["rooms"]})}})},F=a=>{x.post(route("rooms.store"),a,{preserveScroll:!0,onSuccess:()=>{g(!1),x.reload({only:["rooms"]})}})},I=(a,m)=>{x.put(route("rooms.update",a),m,{preserveScroll:!0,onSuccess:()=>{v(null),x.reload({only:["rooms"]})}})},W=a=>{x.delete(route("rooms.destroy",a.id),{preserveScroll:!0,onSuccess:()=>{C(null),x.reload({only:["rooms"]})}})};d.useEffect(()=>{function a(m){z.current&&!z.current.contains(m.target)&&D(!1)}return document.addEventListener("mousedown",a),()=>document.removeEventListener("mousedown",a)},[]);const O=({children:a})=>r?.role==="admin"?e.jsx(Q,{children:a}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:a});return e.jsxs(O,{children:[e.jsx(J,{title:"Salles"}),e.jsx("header",{className:"bg-white shadow-sm sticky top-0 z-10",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4 flex items-center justify-between",children:[r?.role==="admin"?e.jsx(_,{href:route("dashboard"),children:e.jsx(T,{})}):e.jsx(T,{}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"relative",ref:z,children:[e.jsxs("button",{onClick:()=>D(!B),className:"flex items-center gap-2 text-gray-700 hover:text-gray-900",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center",children:r?.name?.[0]?.toUpperCase()||"U"}),e.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:e.jsx("path",{strokeWidth:"2",d:"M6 9l6 6 6-6"})})]}),B&&e.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg py-1 z-50",children:[e.jsx(_,{href:route("profile.edit"),className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Profil"}),e.jsx(_,{href:route("logout"),method:"post",as:"button",className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"DÃ©connexion"})]})]})})]})}),e.jsxs("main",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-3",children:[e.jsx(b,{type:"text",placeholder:"Rechercher des salles...",value:t,onChange:a=>c(a.target.value),className:"w-full md:flex-1"}),e.jsxs("select",{className:"border rounded px-3 py-2 md:w-auto",value:i,onChange:a=>p(a.target.value),children:[e.jsx("option",{value:"all",children:"Tous les types"}),e.jsx("option",{value:"conference",children:"Salle de confÃ©rence"}),e.jsx("option",{value:"office",children:"Bureau"}),e.jsx("option",{value:"training",children:"Salle de formation"})]})]})}),e.jsx("div",{className:"mb-2 flex items-center justify-between",children:e.jsx("h2",{className:"text-2xl font-semibold",children:"Salles disponibles"})}),e.jsxs("div",{className:"flex justify-between items-center flex-wrap gap-4",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[y.length," salle",y.length>1?"s":""," trouvÃ©e",y.length>1?"s":""]}),r?.role==="admin"&&e.jsx(u,{onClick:()=>g(!0),className:"bg-gray-900 hover:bg-black",children:"+ CrÃ©er une salle"})]})]}),y.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500 text-lg",children:"Aucune salle trouvÃ©e"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-8",children:y.map(a=>e.jsx(se,{room:a,user:r,onOpenDetails:$,onOpenEdit:A,onOpenDelete:C,onReserve:V},a.id))}),l?.links&&e.jsx("div",{className:"flex gap-2 mt-8",children:l.links.map((a,m)=>e.jsx(_,{href:a.url||"#",className:`px-2 py-1 rounded border ${a.active?"bg-gray-200":""}`,dangerouslySetInnerHTML:{__html:a.label},preserveState:!0,preserveScroll:!0},m))})]}),N&&e.jsx(te,{onClose:k,onSubmit:F}),h&&e.jsx(Y,{room:h,onClose:k}),o&&e.jsx(Z,{initialRoom:o,onClose:k,onSubmit:I}),f&&e.jsx(ee,{room:f,onCancel:()=>C(null),onConfirm:W}),L&&e.jsx(re,{room:L,employees:R,onClose:k,onSubmit:q})]})}export{ne as default};
